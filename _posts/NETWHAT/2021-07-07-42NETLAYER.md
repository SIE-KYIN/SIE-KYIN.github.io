---
title: NETWHAT(NETWORK)
categories: 
  - 42_NETWHAT
excerpt: "OSI 7layer와 라우팅에 대해 알아보자:)"
date:   2021-07-07 16:00:51 +0900
tags:
- 42seoul
- netwhat
- computer networks
---

# 개요

◦ What is the OSI model

◦ What are the network layers 

◦ What is TCP 

◦ What is UDP 

◦ What is a DHCP server and the DHCP protocol 

◦ What is a DNS server and the DNS protocol 

◦ What is a default gateway for routing 

◦ What is a port from an IP point of view and what is it used for when connecting to another device

<br />
<br />

---

# What is the OSI model

<figure>
	<a href="https://user-images.githubusercontent.com/79088896/124720323-008d5f80-df43-11eb-86b1-2ce4f383fcf0.png">
		<img src="https://user-images.githubusercontent.com/79088896/124720323-008d5f80-df43-11eb-86b1-2ce4f383fcf0.png" class="w8" />
	</a>
</figure>

OSI 7 layer model은 위의 그림과 같은 형태로 나타난다.

이 모델은 다양한 레이어들이 사용되는 국제 표준 프로토콜의 첫 단계로써 ISO에 의해 제안되었다.

이 모델은 ISO OSI(Open Systems Interconnection)참조 모델이라고 불리는데 그 이유는 오픈 시스템을 다루기 때문인데 

오픈 시스템이란 다른 시스템과 오픈된 환경에서 통신하는 시스템을 의미한다.

OSI model은 7개의 레이어에 적용된 다음과 같은 원칙이 있다.

1. 계층마다 추상화의 방법, 수준은 다르다.
2. 각 계층은 각자의 명확한 역할을 수행한다.
3. 각 계층의 기능은 국제 표준 프로토콜을 따른다.
4. 각 계층의 경계는 인터페이스를 통하는 정보 흐름을 최소화하도록 한다.
5. 계층의 수는 한 계층에 역할이 집중되지 않도록 많아야하고 구조가 복잡해지지 않아야한다.

<br />

#### 물리 계층 (Physical Layer)

물리 계층은 통신 채널로서 비트들의 나열을 전송하는 기능을 담당한다. 이 계층은 송신측이 비트 1을 송신하면 수신측이 비트 1 그대로를 수신하도록 해야한다.

그렇기 때문에 Physical Layer의 설계쟁점은 물리적 계층 아래에 위치한 물리 전송매체뿐만 아니라 기계적, 전기적, 그리고 타이밍 인터페이스에 관한 것이다.

이 계층의 대표 장치로 리피터(허브)가 있다. 전송단위는 비트이다. 

<br />

#### 데이터 링크 계층(Data Link Layer)

데이터 링크 계층의 주요임무는 오류 없는 전송을 위해서 전송설비 즉 원시데이터를 회선으로 변환하는 것이다.

송신측은 이 계층에서 데이터를 데이터 프레임으로 나누어서 각 프레임을 순서대로 전송한다.

신뢰할 수 있는 데이터라면 수신측에서 긍정응답을 나타내는 확인응답 프레임(acknowledgement frame)을 송신측에 보낸다.

확인응답 프레임을 간단하게 ack message라고 부른다.

Data Link Layer의 설계 쟁점은 수신측에 과부하가 오도록 송신측이 데이터를 보내지 않도록 하는 것이다.

이를 위해 이 계층에서는 오류제어 및 흐름제어를 진행한다. 이러한 제어들은 트랜스포트 계층에서도 한다.

이 계층의 대표 장치로 브릿지가 있다. 전송단위는 프레임이다.

<br />

#### 네트워크 계층(Network Layer)

네트워크 계층은 서브넷의 동작을 제어한다. 이 계층의 설계쟁점은 송신측에서 수신측으로의 패킷 전송 경로를 결정하는 것이다.

라우터는 네트워크를 물리 케이블로 연결한 망 형상에 대한 정적 테이블에 따라 동작하고 이 테이블은 거의 변경되지 않는다.

전송 경로를 결정하는 것은 매우 동적이어서 현재의 네트워크 부하를 반영하여 각 패킷을 전송하기 위해 라우터들이 새롭게 결정할 수 있다.

만약 동시에 매우 많은 패킷들이 서브넷에 존재할 경우 각각의 패킷들은 다른 패킷들의 경로에 끼어들어 병목현상을 빛게 될 것이다.

이를 방지하기 위해 혼잡 제어를 해줘야한다. 일반적으로 제공되는 QoS(Quality of Service)도 네트워크 계층의 쟁점이다.

패킷이 최종 목적지에 도달하기 위해 네트워크를 통과할 동안 많은 문제들이 발생할 수 있다.

이러한 문제들을 해결하면서 다른 네트워크 간의 상호연결을 제공하는 것이 네트워크 계층의 역할이다.

이 계층의 대표 장치로 라우터가 있다. 전송단위는 패킷이다.

<br />

#### 트랜스포트 계층(Transport Layer)

트랜스포트 계층의 기본 기능은 세션 계층으로부터 전달 받은 데이터를 필요한 경우에만 작은 단위로 분할한 후 

이들을 네트워크 계층으로 전달하고 각 단편들이 모두 수신측에 정확하게 도착하였음을 보장하는 것이다.

또 트랜스포트 계층은 세션 계층에 제공할 서비스 유형과 궁극적으로 네트워크 사용자들에게 제공할 서비스 유형을 결정해야 한다.

가장 대중적인 트랜스포트 계층연결 유형은 전송된 순서대로 메세지 혹은 바이트들을 전달하는 오류없는 점대점(end to end) 채널이다. 

참고로 '오류없는'이라는 것은 불가능하다. 오류율이 무시해도 될만큼 낮은 것을 의미한다.

이 계층의 대표 장치로 게이트웨이가 있다. 전송단위는 세그멘트이다.

이 계층까지를 하위계층이라고 부르며 세션 계층부터는 상위 계층이라고 부른다.

<br />

#### 세션 계층 (Session Layer)

세션 계층은 다른 통신기기상의 사용자들이 그들 간의 세션을 설정할 수 있도록 허용한다.

세션 계층은 대화제어(누가 전송할 차례인지 제어), 토큰 관리(양측이 동시에 같은 동작을 하지 못하게함), 동기화(오류가 발생할 경우 마지막 체크 포인트로 가도록 하는 방법)등의 여러가지 서비스를 제공한다.

<br />

#### 표현 계층(Presentation Layer)

주로 비트를 전송하는 것과 관련된 하위 계층과는 달리, 표현 계층은 전송되는 정보의 구문 및 의미규칙과 관련이 있다.

컴퓨터가 서로 다른 내부의 데이터 표현으로 통신하는 것을 가능하게 하려면 교환되는 데이터 구조가 물리 계층에서 사용되는 표준 부호화에 따라 추상적인 방법으로 정의될 수 있어야한다.

표현 계층은 이러한 추상 데이터 구조를 관리하고 정의 및 교환될 수 있는 고급 데이터 구조를 허용한다.

암호화하는 기능도 이 계층에서 수행된다.

<br />

#### 응용 계층(Application Layer)

응용 계층은 주로 사용자들에게 필요한 여러 가지 프로토콜을 포함한다. 예를들어 HTTP가 있다.



<br />
<br />

---


# What are the network layers 

네트워크 계층은 source 부터 destination까지로 패킷이 도달하는 데 중점을 둔다. 목적지에 도달하기 위해서는 경로를 따라 중간 라우터들에서 많은 전송을 해야한다.

이를 위해서 네트워크 계층은 통신 서브넷의 형태(라우터의 설치 형태)를 알아야하고 그것을 통과할 때 과부하가 오지 않도록 적당한 경로를 결정한다.

이를 위해 라우팅 알고리즘을 이용하는데 네트워크 계층의 소프트웨어 부분으로 들어온 패킷이 어느 회선으로 전송되어야 할지를 결정하는 것이다.

라우팅 알고리즘은 정확성, 단순성, 견고성, 안전성, 공정성, 최적성을 고려하여 설계된다. 

라우팅 알고리즘은 두 가지 주 클래스로 그룹화 될 수 있다. nonadaptive algorithm과 adaptive algorithm인데 이름에서 유추할 수 있듯이

비적응적 알고리즘은 현재 트래픽과 형태의 측정 및 평가에 따라서 설정되는 것이 아니라 경로는 미리 선택되고 네트워크가 부팅될 때 라우터로 다운로드한다.

정적 라우팅(static routing)이라고도 부른다.

반대로 적응적 알고리즘은 형태와 트래픽의 변화를 반영하여 라우팅을 결정한다.

<br />

### 정적 알고리즘


<br />

#### 최단 경로 라우팅(Shortest Path Routing)

최단 경로 라우팅은 목적지까지의 홉의 수를 계산하여 가장 짧은 경로로 패킷을 보내는 것이다.

다익스트라 알고리즘과 같다.


<br />

#### 플러딩(Flooding)

들어온 모든 패킷을 들어온 회선을 제외하고 모든 출력 회선으로 보내는 것을 플러딩이라고 한다.

<br />


### 동적 알고리즘

<br />

#### 거리 벡터 라우팅(Distance vector routing)

이 알고리즘은 각 목적지에 대해 라우팅 테이블을 유지하고 주변의 라우터들과 정보 교환을 통해 갱신하여 가장 짧은 거리를 가지고 있는 목적지로 전송하여 최종 목적지에 전달하는 것이다.

거리 벡터 라우팅은 무한 카운트 문제가 있다.

<br />

#### 링크 상태 라우팅(Link State routing)

현재 인터넷은 링크 상태 라우팅 알고리즘을 채택하여 사용중이다. 

링크 상태 라우팅의 시작은 인접한 라우터들에 대한 학습을 진행하는 것이다. 

그 다음에 인접한 라우터에 도달하기 위한 비용을 측정한다.

교환에 필요한 정보들이 모아지면 다음 단계는 각 라우터가 그 모든 데이터를 포함한 패킷을 만드는 것이다. 이것을 링크 상태 패킷을 만든다고 칭한다.

그 패킷을 분배 알고리즘에 따라 신뢰성있게 분배한다. 라우터가 링크 상태 패킷을 모두 모으면 새로운 경로를 계산한다.

<br />

#### 계층적 라우팅(hierarchical routing)

라우터를 지역(region)단위로 나누어지고 모든 라우터는 자신의 지역에 대해서만 어떻게 전달할지만 알고 다른 지역의 내부구조는 모르게 된다.

네트워크가 연결되면 지역의 특정 라우터는 다른 지역으로 트래픽을 처리할 수 있게 되고 같은 지역의 라우터들은 그 라우터를 이용하여 다른 지역에 패킷을 전송한다.

<br />

#### 브로드캐스트 라우팅(Broadcast routing)

강의나 방송처럼 불특정 다수에게 패킷을 전송하는 알고리즘이다.

<br />

#### 멀티캐스트 라우팅(Multicasting routing)

불특정 다수중에서 그룹화를 하여 특정 그룹에게만 패킷을 전송하는 알고리즘이다.

<br />

#### 이동 호스트를 위한 라우팅(Mobile Host routing)

Mobile과 Portable의 개념을 생각해볼 필요가 있다.

Mobile은 휴대성을 가지고 있으며 계속해서 통신을 주고 받는 것을 의미한다.

Portable은 휴대성만을 의미한다.

모바일 기기의 home address가 있을 것이고 현재 위치의 foriegn address가 있을 것이다.

예를 들어서 설명을 해보겠다.

나의 집은 서울이다. 서울에 나의 모바일 기기는 home agent로부터 부여받은 home address가 있을 것이다.

그런데 내가 부산으로 가면 모바일 기기는 foriegn agent로부터 해당 지역의 local address를 부여받는다. 

그렇다면 모바일 호스트는 이 주소를 home agent에게 알려준다. 나 여기 있을 거니깐 나한테 오는 패킷을 이 주소로 보내줘라는 메시지를 보낸다.

그런 상태에서 제주도에 있는 송신자가 가지고 있는 나의 목적지 주소로 데이터 패킷을 보낸다. 이 때 주소는 home address이다.

그렇다면 home agent는 자신이 알고있는 모바일 호스트의 주소를 담고있는 헤더를 붙여 전송한다 이것을 터널링이라고 부른다.

이제 모바일 호스트는 제주도에서 보낸 송신자의 주소로 나 서울에 없고 부산에 있어요라고 주소를 알려준다. 그렇게 송신자와 모바일 호스트는 지속적인 통신을 할 수 있다.


<br />
<br />

---

# What is UDP 

흔히 트랜스포트 계층에서 비연결형 프로토콜을 UDP라고 한다.

UDP(User Datagram Protocol)는 어플리케이션에 비연결형이고 캡슐화된 IP 데이터그램을 보낸다.

데이타그램이란 독립적인 관계를 가지는 패킷을 의미한다.

UDP는 단순한 프로토콜로써 클라이언트-서버 연동 및 멀티미디어 같은 일부 분야에서만 사용된다.

<figure>
	<a href="https://user-images.githubusercontent.com/79088896/124892949-46b2f380-e015-11eb-8963-d500d60ae6ed.png">
		<img src="https://user-images.githubusercontent.com/79088896/124892949-46b2f380-e015-11eb-8963-d500d60ae6ed.png" class="w8" />
	</a>
</figure>

<br />
<br />

사진과 같이 UDP 헤더에는 목적지주소, 데이터순서, checksum과 실데이터만 포함되고, 확인응답 같은 것이 없기 때문에 TCP보다 용량이 가볍고 송신속도가 빠르다. 

하지만 확인응답(ack message)을 하지 못하기때문에 신뢰도가 TCP보다 떨어지게 된다.

UDP는 체크섬을 이용하여 에러를 검사한다.

<br />
<br />

---


# What is TCP

TCP(Transmission Control Protocol)은 신뢰성 있는 연결형 프로토콜이다.

TCP 서비스는 송신자와 수신자 모두가 소켓이라고 불리는 End Point를 생성함으로써 이루어진다.

각 소켓은 호스트의 IP 주소와 그 호스트에 국한된 16비트 숫자로 구성된 포트(소켓 번호)를 가진다.

아래의 표는 대표적인 포트들에 따른 프로토콜과 용도를 나타낸다.

<br />

| Port | Protocol | Use |
| --- | --- | --- |
| 21 | FTP | File transfer |
| 23| Telnet | Remote login |
| 25 | SMTP | E-mail |
| 69 | TFTP | Trivial file transfer |
| 79 | Finger | Lookup information about a user |
| 80 | HTTP | World Wide Web |
| 110 | POP-3 | Remote E-mail access |
| 119 | NNTP | USENET news|

<br />

`ftp://000.000.000.000:21`와 같이 사용하는 프로토콜과 IP 주소 그다음에 포트 번호를 적는다.

흔히들 사용하는 `https://sie-kyin.github.io/`와 같은 URL 주소를 생각하면 된다. 이경우는 www가 기본적으로 사용하는 80번의 포트 번호를 자동으로 생략한 경우이다.


모든 TCP 연결은 전이중(full-duplex), 점대점(point-to-point) 방식이다. 

전이중이란 전송이 양방향으로 동시에 일어날 수 있음을 의미한다.

점대점이란 각 연결이 정확히 2개의 연결 end point를 가지고 있음을 의미한다. 따라서 멀티캐스팅이나 브로드캐스팅을 지원하지 않으며 유니캐스트 통신을 한다.

송수신 TCP 개체들은 세그먼트의 형태로서 데이터를 주고 받는다. 세그먼트 형태란 고정 20바이트 헤더 + 그 뒤의 데이터 바이트들을 의미한다.

모든 네트워크는 정해진 MTU(Maximum Transfer Unit)을 가지는데, 각 세그먼트는 이더넷의 페이로드 크기인 1500바이트를 넘길 수 없다.

<figure>
	<a href="https://user-images.githubusercontent.com/79088896/124896494-70214e80-e018-11eb-88cf-3477fdc09ebf.png">
		<img src="https://user-images.githubusercontent.com/79088896/124896494-70214e80-e018-11eb-88cf-3477fdc09ebf.png" class="w8" />
	</a>
</figure>

<br />
<br />

TCP Header는 위의 사진과 같은 구조를 가진다.

우선 송신 포트와 목적지 포트의 정보가 담겨있다.

Sequence number와 Acknowledgement number는 흔히들 사용하는 기능을 수행한다.

TCP header length는 말 그대로 헤더 세그먼트의 길이를 알려준다. 옵션 필드의 길이는 가변적이기 때문에 명시해준다.

그다음에 사용하지 않는 4비트가 온다. 

이제 여덟개의 1-비트 플래그들이 온다. 

TCP 수신자가 네트워크로부터 혼잡 조짐을 받았을 때, TCP 송신자에게 전송속도를 낮추라는 ECN 신호를 ECE가 설정해서 보낸다.

CWR은 송신자가 전송 속도를 줄였으니 ECN 신호를 그만 보낼 것을 요청한다.

URG는 Urgent Pointer가 사용 중일 때 설정된다. 

ACK는 Acknowledge number가 유효함을 나타낸다. 만약 0이라면 Acknowledge number필드는 무시된다.

PSH는 push된 데이터를 나타낸다. 

RST은 불안정한 연결을 리셋하거나 잘못된 세그먼트를 기각할 때 사용된다.

SYN은 연결요청과 연결수락을 나타내기 위해 사용된다.

FIN은 송신자가 보낼 데이터가 더이상 없을 때 사용된다.

TCP에서 흐름 제어는 가변크기의 슬라이딩 윈도우를 사용하여 처리된다. Window Size는 확인응답된 바이트에서 얼마나 많은 바이트가 보내질 수 있는지를 나타낸다.

Checksum은 신뢰성을 높이기 위해 검사하는 부분이다.

Option은 기본 헤더로 할 수 없는 기능들을 추가하는 부분이다.



<br />
<br />

---


# What is the difference between TCP and UDP

| TCP | UDP | 
| --- | --- | 
| Connection-oriented Protocal | Connection-less Protocal | 
| BYTE stream service | Datagram service | 
| 혼잡제어, 흐름제어 지원 | 혼잡제어, 흐름제어 지원안함 |
| 신뢰성있는 연결 | 신뢰성 없는 연결 | 
| HTTP, SMTP등 | DNS, Broadcasting, Live Streaming | 

<figure>
	<a href="https://user-images.githubusercontent.com/79088896/124900282-e5425300-e01b-11eb-9cf3-3d2439c4aeda.JPG">
		<img src="https://user-images.githubusercontent.com/79088896/124900282-e5425300-e01b-11eb-9cf3-3d2439c4aeda.JPG" class="w8" />
	</a>
</figure>

<br />
<br />

---


# What is a DHCP server and the DHCP protocol

DHCP(Dynamic Host Configuration Protocol)란 네트워크 안에 컴퓨터에 자동으로 네임 서버 주소, IP주소, 게이트웨이 주소를 할당해주는 것을 의미하고, 해당 클라이언트에게 일정 기간 임대를 하는 동적 주소 할당 프로토콜이다.

DHCP는 DHCP서버와 클라이언트로 구성되어있는데 서버는 클라이언트에게 IP 할당 요청이 들어오면 IP를 부여해주고 할당 가능한 IP들을 관리한다. 

클라이언트는 네트워크 부팅과정에서 DHCP서버에 IP주소를 요청하고 통신이 가능하게 한다.

DHCP는 임대 개념을 생각하면되는데 IP주소를 요청하면 서버는 임대기간을 정해서 할당을 해준다. 임대기간 후에도 계속 사용하고자 한다면 서버에 연장을 요청하면 되고 사용을 마쳤다면 반납을 한다.

이를 사용하는 이유는 다른 프로토콜들과 비슷하게 IP주소는 한정적이기 때문이다.

DHCP는 UDP 프로토콜이다.

67번 포트를 통해 클라이언트는 DHCP서버에 요청 신호를 보내고 68번 포트는 DHCP 서버의 응답을 수신하는데 사용한다.

<br />
<br />

---

# What is a DNS server and the DNS protocol

DNS(Domain Name System) protocal은 말 그대로 DNS는 도메인 이름과 IP 주소를 서로 변환하여 사용하는 것을 말한다.

도메인 네임이라고 들어본 적이 있다. 예를 들어 네이버를 들어가기 위해 naver.com을 주소창에 입력한다.

여기서 naver.com이 도메인 네임이다. 네이버 홈페이지의 진짜 이름은 터미널에 `ping naver.com`을 입력해보면 알 수 있다.

`125.209.222.141`를 주소창에 입력하면 naver.com을 입력했을 때와 같이 네이버 홈페이지에 접속할 수 있다.

<br />
<br />

---

# What is a default gateway for routing 

Default Gateway는 기본적으로 설정된 라우팅 경로이다.

특정 목적지로 가는 데이터패킷이 유입이 되었는데, 해당 목적지를 라우터가 알지 못한다면 해당 패킷은 Default Gateway로 전달한다.
